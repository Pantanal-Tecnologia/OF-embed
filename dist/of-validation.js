class OfEmbed{callback=()=>{};devMode=!1;token=null;sistema=null;tipo=null;stackId=null;user=null;hash=null;endPointBack="https://of.pantanaltec.com.br";endPointFront="https://of.pantanaltec.com.br";setSistema=t=>this.sistema=t;setToken=t=>this.token=t;setDevMode=t=>{this.devMode=t,this.devMode?(this.endPointBack="http://localhost:3000",this.endPointFront="http://localhost:8080"):(this.endPointBack="https://of.pantanaltec.com.br",this.endPointFront="https://of.pantanaltec.com.br")};addModal(t,e){let a=document.createElement("iframe");a.classList.add("modal-iframe");let o=this.endPointFront+t;if(console.log(o),a.src=o,e)e?.appendChild(a);else{let n=document.createElement("div");n.classList.add("modal-background");let d=document.createElement("div");return d.classList.add("modal-content"),d.appendChild(a),n.appendChild(d),document.body.appendChild(n),n.addEventListener("click",()=>this.closeModal(n)),n.style.display="block",n}}addWindow(t){let e=this.endPointFront+t;window.innerWidth,window.innerHeight,window.open(e,"ofNfValidation")}closeModal(t){t.style.display="none",setTimeout(()=>{document.body.removeChild(t),t=void 0},1e3);try{this.callback()}catch(e){}}validacaoFornecedor(t,e,a=t=>!0,o=[],n=null){console.log(n);let d={modal:!0,target:!1};"object"==typeof n&&(d={...d,...n}),console.log(d),this.callback=a;let s=e.join(","),i=JSON.stringify(o),l=`/#/API/${this.sistema}/validacaoFornecedor/${t}/${s}/${this.token}/${btoa(i)}`,r=null;d.modal?r=this.addModal(l,d.target):this.addWindow(l),window.addEventListener("message",t=>{console.log("message FROM",t.origin,this.endPointFront,this.endPointFront==t.origin),t.origin===this.endPointFront&&(console.log("Mensagem recebida:",t.data,"OK"==t.data),"OK"==t.data?(r&&this.closeModal(r),a()):alert(t.data))},!1)}getTransacoesDocStatus(t,e,a=t=>!0){return new Promise((a,o)=>{let n=new Headers;n.append("Content-Type","application/json;charset=UTF-8"),n.append("Access-Control-Allow-Origin","*"),n.append("x-access-token",this.token);let d={layout:t,sistema:this.sistema,transacoes:e},s={body:JSON.stringify(d),method:"POST",headers:n,mode:"cors",cache:"default"};fetch(this.endPointBack+"/loadRelatorioTransacoesDataAPI",s).then(async function(t){let e=await t.json(),o={};e?.transacoes?.forEach(t=>{o[t.produtoId]||(o[t.produtoId]={}),o[t.produtoId][t.id]=!!t.nfId&&t.docs}),a(o)}).catch(t=>o(t))})}getPreData(t){return new Promise((e,a)=>{if(!(t.cliente&&t.contrato&&t.credenciador&&t.departamento&&t.fornecedor&&t.produto&&t.secretaria&&t.sistema))throw console.log(t),"Dados Invalidos";let o=`/getValidationData?sistema=${t.sistema}&credenciador=${t.credenciador}&cliente=${t.cliente}&secretaria=${t.secretaria}&departamento=${t.departamento}&contrato=${t.contrato}&produto=${t.produto}&fornecedor=${t.fornecedor}`;t.layout&&(o+=`&layout=${t.layout}`),t.transacoes&&(o+=`&transacoes=${t.transacoes}`),fetch(this.endPointBack+o).then(t=>{e(t.json())}).catch(t=>{a(t)})})}}